package api

import (
	"bytes"
	"log"
	"testing"
)

const FIXTURES = [...]string{
	"4d0000009063fb5acc43357801000403bede0005125000004702b80000000000006303b0021270011c80000008790c01000000000000000000000000cf813ff1052c3656f253359abd2c60603466c8e58e736aeb6d67312c703695157bfc81c9cf75a081a22839ed63d814d15b646ccaaaaf3470c9b9da39d7513f04a977261589a2ae1f2a8cce81b7528597cdcc3a192cf6552c0b52771b694d978a4371de02204205970b0577a849332ae8fb78febb9bef6642876004c626a584cb3bb49002ee88de723dd31ce1a1755ee485e7d40643cab81de9a99611aa53074018743b06f70ef77f9591c6db9c7fa562be0c4173ff43013e559462d2b418729b4506887155842a90112865a1a78a0d4b89f3eb675b73fa2264f4e4c95e576579f9756cae2c01c77ae976a7cd87dc2d0ffa2444919807aa78cffa89a5812399b6911a81cf3ab16d02dd493c6fe27a5fe475cc190ccae737248dfba0a03bab3fe3ec6c500d3d9226a15775571592da298a5dc9e6cb356743b0d5dd5e8a5502f3b074a5fe0b53720942615ebb849637fdf595a31be044ca1fb9a97d59d1b603ed00583bd83d00c685c86fc9759501728f84b40a96841fafa6382a3dee235a55ba0acef4427284a95153aa75f5d46a7dfc9a992682b34aeb9ea8ccb5723f72b749098ee77882780d40f4d61aa9fdc96c3094778589cab73934cf96fdba93ab6bd70ff891ac322dec072e85841047df1f9c1ae56804e23314a4a831c1250e6bc8813e261ba412364a752b7851a206e8e4846f30e5e4f70110f196328273f94ee6e8437dfc085b4aa1930a1a302e4cbbc24ba7d0e57c19b2722ba1c2e1aab3a3fe3e260d8946a9741c8a4a53ec463dabecb403c8a3b8af1970a9f33f38538c5120e64701084caf4eb07121b4ba9a7db9d01643f6c3177b976498604a3378356ebfab59d2ccc3831295abc6ee2ce507472c3fc8243a986edb694efb85a6ef13658e809529f203fd5d91b579c4ce73114992bb9f5b925023bc0571a9331024395e7f34bd91df1250aba20eb1621b9c877ecd1d895492bb636158a7563cedd2ce230ba38bc716b43783e8529c087f4578f7",
}

func TestZoomParser(t *testing.T) {

	encoder := NewZoomRtpEncoder(160)
	decoder := NewZoomRtpDecoder()

	// Encode the payload
	rtpPkt, err := encoder.Encode(payload)
	if err != nil {
		log.Fatal(err.Error())
	}
	// Decode the payload
	decoded, err := decoder.Decode(rtpPkt)
	if err != nil {
		log.Fatal(err.Error())
	}
	log.Printf("rtpPkt=%v", rtpPkt)
	log.Printf("payload=%v", payload)
	log.Printf("decoded=%v", decoded)
	if bytes.Compare(payload, decoded) != 0 {
		log.Fatal("Decoding failed")
	}
}
